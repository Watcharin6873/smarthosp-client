import{i as B,j as $,g as j,f as L,b as I,a as A,e as F}from"./@babel-CNPOxmrp.js";import{r as n}from"./react-DtcBd6oJ.js";import{s as K,i as T,e as V,R as C,y as X}from"./rc-util-DhJyx-BV.js";import{i as Y}from"./resize-observer-polyfill-B1PUzC5B.js";var b=n.createContext(null);function q(e){var i=e.children,r=e.onBatchResize,a=n.useRef(0),t=n.useRef([]),o=n.useContext(b),d=n.useCallback(function(v,u,s){a.current+=1;var h=a.current;t.current.push({size:v,element:u,data:s}),Promise.resolve().then(function(){h===a.current&&(r==null||r(t.current),t.current=[])}),o==null||o(v,u,s)},[r,o]);return n.createElement(b.Provider,{value:d},i)}var c=new Map;function G(e){e.forEach(function(i){var r,a=i.target;(r=c.get(a))===null||r===void 0||r.forEach(function(t){return t(a)})})}var M=new Y(G);function J(e,i){c.has(e)||(c.set(e,new Set),M.observe(e)),c.get(e).add(i)}function Q(e,i){c.has(e)&&(c.get(e).delete(i),c.get(e).size||(M.unobserve(e),c.delete(e)))}var U=function(e){B(r,e);var i=$(r);function r(){return j(this,r),i.apply(this,arguments)}return L(r,[{key:"render",value:function(){return this.props.children}}]),r}(n.Component);function Z(e,i){var r=e.children,a=e.disabled,t=n.useRef(null),o=n.useRef(null),d=n.useContext(b),v=typeof r=="function",u=v?r(t):r,s=n.useRef({width:-1,height:-1,offsetWidth:-1,offsetHeight:-1}),h=!v&&n.isValidElement(u)&&K(u),O=h?T(u):null,D=V(O,t),z=function(){var l;return C(t.current)||(t.current&&A(t.current)==="object"?C((l=t.current)===null||l===void 0?void 0:l.nativeElement):null)||C(o.current)};n.useImperativeHandle(i,function(){return z()});var E=n.useRef(e);E.current=e;var _=n.useCallback(function(f){var l=E.current,w=l.onResize,N=l.data,y=f.getBoundingClientRect(),p=y.width,m=y.height,R=f.offsetWidth,g=f.offsetHeight,x=Math.floor(p),W=Math.floor(m);if(s.current.width!==x||s.current.height!==W||s.current.offsetWidth!==R||s.current.offsetHeight!==g){var k={width:x,height:W,offsetWidth:R,offsetHeight:g};s.current=k;var P=R===Math.round(p)?p:R,S=g===Math.round(m)?m:g,H=I(I({},k),{},{offsetWidth:P,offsetHeight:S});d==null||d(H,f,N),w&&Promise.resolve().then(function(){w(H,f)})}},[]);return n.useEffect(function(){var f=z();return f&&!a&&J(f,_),function(){return Q(f,_)}},[t.current,a]),n.createElement(U,{ref:o},h?n.cloneElement(u,{ref:D}):u)}var ee=n.forwardRef(Z),re="rc-observer-key";function ne(e,i){var r=e.children,a=typeof r=="function"?[r]:X(r);return a.map(function(t,o){var d=(t==null?void 0:t.key)||"".concat(re,"-").concat(o);return n.createElement(ee,F({},e,{key:d,ref:o===0?i:void 0}),t)})}var te=n.forwardRef(ne);te.Collection=q;export{te as R};
