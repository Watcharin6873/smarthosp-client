import{b as d,a as p,e as I,d as Q}from"./@babel-CNPOxmrp.js";import{P as ve}from"./@rc-component-CJwU0uVR.js";import{r as a,R as f}from"./react-DtcBd6oJ.js";import{c as k}from"./classnames-BK5ccKcQ.js";import{e as Ce,B as le,n as ye,H as ee,K as ne}from"./rc-util-DhJyx-BV.js";import{C as re}from"./rc-motion-DKWxMSiS.js";var oe=a.createContext({});function te(n,e,t){var l=e;return!l&&t&&(l="".concat(n,"-").concat(t)),l}function ae(n,e){var t=n["page".concat(e?"Y":"X","Offset")],l="scroll".concat(e?"Top":"Left");if(typeof t!="number"){var o=n.document;t=o.documentElement[l],typeof t!="number"&&(t=o.body[l])}return t}function be(n){var e=n.getBoundingClientRect(),t={left:e.left,top:e.top},l=n.ownerDocument,o=l.defaultView||l.parentWindow;return t.left+=ae(o),t.top+=ae(o,!0),t}const Ne=a.memo(function(n){var e=n.children;return e},function(n,e){var t=e.shouldUpdate;return!t});var ge={width:0,height:0,overflow:"hidden",outline:"none"},Re={outline:"none"},he=f.forwardRef(function(n,e){var t=n.prefixCls,l=n.className,o=n.style,m=n.title,c=n.ariaId,v=n.footer,r=n.closable,C=n.closeIcon,N=n.onClose,b=n.children,y=n.bodyStyle,E=n.bodyProps,R=n.modalRender,S=n.onMouseDown,x=n.onMouseUp,T=n.holderRef,O=n.visible,_=n.forceRender,g=n.width,D=n.height,i=n.classNames,u=n.styles,H=f.useContext(oe),B=H.panel,X=Ce(T,B),A=a.useRef(),V=a.useRef();f.useImperativeHandle(e,function(){return{focus:function(){var h;(h=A.current)===null||h===void 0||h.focus({preventScroll:!0})},changeActive:function(h){var q=document,L=q.activeElement;h&&L===V.current?A.current.focus({preventScroll:!0}):!h&&L===A.current&&V.current.focus({preventScroll:!0})}}});var U={};g!==void 0&&(U.width=g),D!==void 0&&(U.height=D);var w=v?f.createElement("div",{className:k("".concat(t,"-footer"),i==null?void 0:i.footer),style:d({},u==null?void 0:u.footer)},v):null,P=m?f.createElement("div",{className:k("".concat(t,"-header"),i==null?void 0:i.header),style:d({},u==null?void 0:u.header)},f.createElement("div",{className:"".concat(t,"-title"),id:c},m)):null,M=a.useMemo(function(){return p(r)==="object"&&r!==null?r:r?{closeIcon:C??f.createElement("span",{className:"".concat(t,"-close-x")})}:{}},[r,C,t]),$=le(M,!0),W=p(r)==="object"&&r.disabled,Y=r?f.createElement("button",I({type:"button",onClick:N,"aria-label":"Close"},$,{className:"".concat(t,"-close"),disabled:W}),M.closeIcon):null,K=f.createElement("div",{className:k("".concat(t,"-content"),i==null?void 0:i.content),style:u==null?void 0:u.content},Y,P,f.createElement("div",I({className:k("".concat(t,"-body"),i==null?void 0:i.body),style:d(d({},y),u==null?void 0:u.body)},E),b),w);return f.createElement("div",{key:"dialog-element",role:"dialog","aria-labelledby":m?c:null,"aria-modal":"true",ref:X,style:d(d({},o),U),className:k(t,l),onMouseDown:S,onMouseUp:x},f.createElement("div",{ref:A,tabIndex:0,style:Re},f.createElement(Ne,{shouldUpdate:O||_},R?R(K):K)),f.createElement("div",{tabIndex:0,ref:V,style:ge}))}),ie=a.forwardRef(function(n,e){var t=n.prefixCls,l=n.title,o=n.style,m=n.className,c=n.visible,v=n.forceRender,r=n.destroyOnClose,C=n.motionName,N=n.ariaId,b=n.onVisibleChanged,y=n.mousePosition,E=a.useRef(),R=a.useState(),S=Q(R,2),x=S[0],T=S[1],O={};x&&(O.transformOrigin=x);function _(){var g=be(E.current);T(y&&(y.x||y.y)?"".concat(y.x-g.left,"px ").concat(y.y-g.top,"px"):"")}return a.createElement(re,{visible:c,onVisibleChanged:b,onAppearPrepare:_,onEnterPrepare:_,forceRender:v,motionName:C,removeOnLeave:r,ref:E},function(g,D){var i=g.className,u=g.style;return a.createElement(he,I({},n,{ref:e,title:l,ariaId:N,prefixCls:t,holderRef:D,style:d(d(d({},u),o),O),className:k(m,i)}))})});ie.displayName="Content";var ke=function(e){var t=e.prefixCls,l=e.style,o=e.visible,m=e.maskProps,c=e.motionName,v=e.className;return a.createElement(re,{key:"mask",visible:o,motionName:c,leavedClassName:"".concat(t,"-mask-hidden")},function(r,C){var N=r.className,b=r.style;return a.createElement("div",I({ref:C,style:d(d({},b),l),className:k("".concat(t,"-mask"),N,v)},m))})},Ee=function(e){var t=e.prefixCls,l=t===void 0?"rc-dialog":t,o=e.zIndex,m=e.visible,c=m===void 0?!1:m,v=e.keyboard,r=v===void 0?!0:v,C=e.focusTriggerAfterClose,N=C===void 0?!0:C,b=e.wrapStyle,y=e.wrapClassName,E=e.wrapProps,R=e.onClose,S=e.afterOpenChange,x=e.afterClose,T=e.transitionName,O=e.animation,_=e.closable,g=_===void 0?!0:_,D=e.mask,i=D===void 0?!0:D,u=e.maskTransitionName,H=e.maskAnimation,B=e.maskClosable,X=B===void 0?!0:B,A=e.maskStyle,V=e.maskProps,U=e.rootClassName,w=e.classNames,P=e.styles,M=a.useRef(),$=a.useRef(),W=a.useRef(),Y=a.useState(c),K=Q(Y,2),j=K[0],h=K[1],q=ye();function L(){ee($.current,document.activeElement)||(M.current=document.activeElement)}function se(){if(!ee($.current,document.activeElement)){var s;(s=W.current)===null||s===void 0||s.focus()}}function ce(s){if(s)se();else{if(h(!1),i&&M.current&&N){try{M.current.focus({preventScroll:!0})}catch{}M.current=null}j&&(x==null||x())}S==null||S(s)}function F(s){R==null||R(s)}var z=a.useRef(!1),G=a.useRef(),ue=function(){clearTimeout(G.current),z.current=!0},de=function(){G.current=setTimeout(function(){z.current=!1})},Z=null;X&&(Z=function(J){z.current?z.current=!1:$.current===J.target&&F(J)});function fe(s){if(r&&s.keyCode===ne.ESC){s.stopPropagation(),F(s);return}c&&s.keyCode===ne.TAB&&W.current.changeActive(!s.shiftKey)}a.useEffect(function(){c&&(h(!0),L())},[c]),a.useEffect(function(){return function(){clearTimeout(G.current)}},[]);var me=d(d(d({zIndex:o},b),P==null?void 0:P.wrapper),{},{display:j?null:"none"});return a.createElement("div",I({className:k("".concat(l,"-root"),U)},le(e,{data:!0})),a.createElement(ke,{prefixCls:l,visible:i&&c,motionName:te(l,u,H),style:d(d({zIndex:o},A),P==null?void 0:P.mask),maskProps:V,className:w==null?void 0:w.mask}),a.createElement("div",I({tabIndex:-1,onKeyDown:fe,className:k("".concat(l,"-wrap"),y,w==null?void 0:w.wrapper),ref:$,onClick:Z,style:me},E),a.createElement(ie,I({},e,{onMouseDown:ue,onMouseUp:de,ref:W,closable:g,ariaId:q,prefixCls:l,visible:c&&j,onClose:F,onVisibleChanged:ce,motionName:te(l,T,O)}))))},Se=function(e){var t=e.visible,l=e.getContainer,o=e.forceRender,m=e.destroyOnClose,c=m===void 0?!1:m,v=e.afterClose,r=e.panelRef,C=a.useState(t),N=Q(C,2),b=N[0],y=N[1],E=a.useMemo(function(){return{panel:r}},[r]);return a.useEffect(function(){t&&y(!0)},[t]),!o&&c&&!b?null:a.createElement(oe.Provider,{value:E},a.createElement(ve,{open:t||o||b,autoDestroy:!1,getContainer:l,autoLock:t||b},a.createElement(Ee,I({},e,{destroyOnClose:c,afterClose:function(){v==null||v(),y(!1)}}))))};Se.displayName="Dialog";export{Se as D,he as P};
