import{_ as y,e as T,c as De,d as L,a as Ye}from"./@babel-CNPOxmrp.js";import{n as ye,t as Ee,g as h,a as Ie,v as ze,b as te}from"./@rc-component-CJwU0uVR.js";import{c as le}from"./classnames-BK5ccKcQ.js";import{B as Ge,t as Je}from"./rc-input-CWadQfp9.js";import{r}from"./react-DtcBd6oJ.js";import{w as Qe,t as j,M as Xe,N as Ze,O as ue,f as en}from"./rc-util-DhJyx-BV.js";function nn(e,o){var u=r.useRef(null);function x(){try{var f=e.selectionStart,m=e.selectionEnd,c=e.value,d=c.substring(0,f),v=c.substring(m);u.current={start:f,end:m,value:c,beforeTxt:d,afterTxt:v}}catch{}}function E(){if(e&&u.current&&o)try{var f=e.value,m=u.current,c=m.beforeTxt,d=m.afterTxt,v=m.start,s=f.length;if(f.startsWith(c))s=c.length;else if(f.endsWith(d))s=f.length-u.current.afterTxt.length;else{var N=c[v-1],p=f.indexOf(N,v-1);p!==-1&&(s=p+1)}e.setSelectionRange(s,s)}catch(g){Qe(!1,"Something warning of cursor restore. Please fire issue about this: ".concat(g.message))}}return[x,E]}var an=200,rn=600;function tn(e){var o=e.prefixCls,u=e.upNode,x=e.downNode,E=e.upDisabled,f=e.downDisabled,m=e.onStep,c=r.useRef(),d=r.useRef([]),v=r.useRef();v.current=m;var s=function(){clearTimeout(c.current)},N=function(I,A){I.preventDefault(),s(),v.current(A);function D(){v.current(A),c.current=setTimeout(D,an)}c.current=setTimeout(D,rn)};r.useEffect(function(){return function(){s(),d.current.forEach(function(S){return j.cancel(S)})}},[]);var p=Xe();if(p)return null;var g="".concat(o,"-handler"),V=le(g,"".concat(g,"-up"),y({},"".concat(g,"-up-disabled"),E)),M=le(g,"".concat(g,"-down"),y({},"".concat(g,"-down-disabled"),f)),b=function(){return d.current.push(j(s))},C={unselectable:"on",role:"button",onMouseUp:b,onMouseLeave:b};return r.createElement("div",{className:"".concat(g,"-wrap")},r.createElement("span",T({},C,{onMouseDown:function(I){N(I,!0)},"aria-label":"Increase Value","aria-disabled":E,className:V}),u||r.createElement("span",{unselectable:"on",className:"".concat(o,"-handler-up-inner")})),r.createElement("span",T({},C,{onMouseDown:function(I){N(I,!1)},"aria-label":"Decrease Value","aria-disabled":f,className:M}),x||r.createElement("span",{unselectable:"on",className:"".concat(o,"-handler-down-inner")})))}function we(e){var o=typeof e=="number"?ye(e):Ee(e).fullStr,u=o.includes(".");return u?Ee(o.replace(/(\d)\.(\d)/g,"$1$2.")).fullStr:e+"0"}const un=function(){var e=r.useRef(0),o=function(){j.cancel(e.current)};return r.useEffect(function(){return o},[]),function(u){o(),e.current=j(function(){u()})}};var ln=["prefixCls","className","style","min","max","step","defaultValue","value","disabled","readOnly","upHandler","downHandler","keyboard","changeOnWheel","controls","classNames","stringMode","parser","formatter","precision","decimalSeparator","onChange","onInput","onPressEnter","onStep","changeOnBlur","domRef"],sn=["disabled","style","prefixCls","value","prefix","suffix","addonBefore","addonAfter","className","classNames"],xe=function(o,u){return o||u.isEmpty()?u.toString():u.toNumber()},Ce=function(o){var u=h(o);return u.isInvalidate()?null:u},on=r.forwardRef(function(e,o){var u=e.prefixCls,x=e.className,E=e.style,f=e.min,m=e.max,c=e.step,d=c===void 0?1:c,v=e.defaultValue,s=e.value,N=e.disabled,p=e.readOnly,g=e.upHandler,V=e.downHandler,M=e.keyboard,b=e.changeOnWheel,C=b===void 0?!1:b,S=e.controls,I=S===void 0?!0:S;e.classNames;var A=e.stringMode,D=e.parser,O=e.formatter,_=e.precision,B=e.decimalSeparator,Y=e.onChange,z=e.onInput,G=e.onPressEnter,J=e.onStep,se=e.changeOnBlur,Ve=se===void 0?!0:se,Me=e.domRef,Oe=De(e,ln),ie="".concat(u,"-input"),F=r.useRef(null),_e=r.useState(!1),oe=L(_e,2),Q=oe[0],fe=oe[1],w=r.useRef(!1),H=r.useRef(!1),K=r.useRef(!1),Be=r.useState(function(){return h(s??v)}),ce=L(Be,2),i=ce[0],de=ce[1];function Ue(a){s===void 0&&de(a)}var X=r.useCallback(function(a,n){if(!n)return _>=0?_:Math.max(Ie(a),Ie(d))},[_,d]),Z=r.useCallback(function(a){var n=String(a);if(D)return D(n);var l=n;return B&&(l=l.replace(B,".")),l.replace(/[^\w.-]+/g,"")},[D,B]),ee=r.useRef(""),ve=r.useCallback(function(a,n){if(O)return O(a,{userTyping:n,input:String(ee.current)});var l=typeof a=="number"?ye(a):a;if(!n){var t=X(l,n);if(ze(l)&&(B||t>=0)){var R=B||".";l=te(l,R,t)}}return l},[O,X,B]),$e=r.useState(function(){var a=v??s;return i.isInvalidate()&&["string","number"].includes(Ye(a))?Number.isNaN(a)?"":a:ve(i.toString(),!1)}),me=L($e,2),P=me[0],pe=me[1];ee.current=P;function W(a,n){pe(ve(a.isInvalidate()?a.toString(!1):a.toString(!n),n))}var U=r.useMemo(function(){return Ce(m)},[m,_]),$=r.useMemo(function(){return Ce(f)},[f,_]),ge=r.useMemo(function(){return!U||!i||i.isInvalidate()?!1:U.lessEquals(i)},[U,i]),Ne=r.useMemo(function(){return!$||!i||i.isInvalidate()?!1:i.lessEquals($)},[$,i]),Ae=nn(F.current,Q),be=L(Ae,2),Fe=be[0],He=be[1],Se=function(n){return U&&!n.lessEquals(U)?U:$&&!$.lessEquals(n)?$:null},ne=function(n){return!Se(n)},q=function(n,l){var t=n,R=ne(t)||t.isEmpty();if(!t.isEmpty()&&!l&&(t=Se(t)||t,R=!0),!p&&!N&&R){var k=t.toString(),re=X(k,l);return re>=0&&(t=h(te(k,".",re)),ne(t)||(t=h(te(k,".",re,!0)))),t.equals(i)||(Ue(t),Y==null||Y(t.isEmpty()?null:xe(A,t)),s===void 0&&W(t,l)),t}return i},Pe=un(),Re=function a(n){if(Fe(),ee.current=n,pe(n),!H.current){var l=Z(n),t=h(l);t.isNaN()||q(t,!0)}z==null||z(n),Pe(function(){var R=n;D||(R=n.replace(/ã€‚/g,".")),R!==n&&a(R)})},We=function(){H.current=!0},ke=function(){H.current=!1,Re(F.current.value)},Ke=function(n){Re(n.target.value)},ae=function(n){var l;if(!(n&&ge||!n&&Ne)){w.current=!1;var t=h(K.current?we(d):d);n||(t=t.negate());var R=(i||h(0)).add(t.toString()),k=q(R,!1);J==null||J(xe(A,k),{offset:K.current?we(d):d,type:n?"up":"down"}),(l=F.current)===null||l===void 0||l.focus()}},he=function(n){var l=h(Z(P)),t;l.isNaN()?t=q(i,n):t=q(l,n),s!==void 0?W(i,!1):t.isNaN()||W(t,!1)},qe=function(){w.current=!0},Le=function(n){var l=n.key,t=n.shiftKey;w.current=!0,K.current=t,l==="Enter"&&(H.current||(w.current=!1),he(!1),G==null||G(n)),M!==!1&&!H.current&&["Up","ArrowUp","Down","ArrowDown"].includes(l)&&(ae(l==="Up"||l==="ArrowUp"),n.preventDefault())},Te=function(){w.current=!1,K.current=!1};r.useEffect(function(){if(C&&Q){var a=function(t){ae(t.deltaY<0),t.preventDefault()},n=F.current;if(n)return n.addEventListener("wheel",a,{passive:!1}),function(){return n.removeEventListener("wheel",a)}}});var je=function(){Ve&&he(!1),fe(!1),w.current=!1};return ue(function(){i.isInvalidate()||W(i,!1)},[_,O]),ue(function(){var a=h(s);de(a);var n=h(Z(P));(!a.equals(n)||!w.current||O)&&W(a,w.current)},[s]),ue(function(){O&&He()},[P]),r.createElement("div",{ref:Me,className:le(u,x,y(y(y(y(y({},"".concat(u,"-focused"),Q),"".concat(u,"-disabled"),N),"".concat(u,"-readonly"),p),"".concat(u,"-not-a-number"),i.isNaN()),"".concat(u,"-out-of-range"),!i.isInvalidate()&&!ne(i))),style:E,onFocus:function(){fe(!0)},onBlur:je,onKeyDown:Le,onKeyUp:Te,onCompositionStart:We,onCompositionEnd:ke,onBeforeInput:qe},I&&r.createElement(tn,{prefixCls:u,upNode:g,downNode:V,upDisabled:ge,downDisabled:Ne,onStep:ae}),r.createElement("div",{className:"".concat(ie,"-wrap")},r.createElement("input",T({autoComplete:"off",role:"spinbutton","aria-valuemin":f,"aria-valuemax":m,"aria-valuenow":i.isInvalidate()?null:i.toString(),step:d},Oe,{ref:en(F,o),className:ie,value:P,onChange:Ke,disabled:N,readOnly:p}))))}),gn=r.forwardRef(function(e,o){var u=e.disabled,x=e.style,E=e.prefixCls,f=E===void 0?"rc-input-number":E,m=e.value,c=e.prefix,d=e.suffix,v=e.addonBefore,s=e.addonAfter,N=e.className,p=e.classNames,g=De(e,sn),V=r.useRef(null),M=r.useRef(null),b=r.useRef(null),C=function(I){b.current&&Je(b.current,I)};return r.useImperativeHandle(o,function(){return Ze(b.current,{focus:C,nativeElement:V.current.nativeElement||M.current})}),r.createElement(Ge,{className:N,triggerFocus:C,prefixCls:f,value:m,disabled:u,style:x,prefix:c,suffix:d,addonAfter:s,addonBefore:v,classNames:p,components:{affixWrapper:"div",groupWrapper:"div",wrapper:"div",groupAddon:"div"},ref:V},r.createElement(on,T({prefixCls:f,disabled:u,ref:b,domRef:M,className:p==null?void 0:p.input},g)))});export{gn as I};
